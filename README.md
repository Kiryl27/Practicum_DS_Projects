# linear ml models

Разработать модель машинного обучения, которая поможет управлять рисками и принимать объективное решение о покупке коровы

Описание данных:

Файл ferma_main.csv содержит данные о стаде фермера на текущий момент:

id — уникальный идентификатор коровы. Удой, кг — масса молока, которую корова даёт в год (в килограммах). ЭКЕ (Энергетическая кормовая единица) — показатель питательности корма коровы. Сырой протеин, г — содержание сырого протеина в корме (в граммах). СПО (Сахаро-протеиновое соотношение) — отношение сахара к протеину в корме коровы. Порода — порода коровы. Тип пастбища — ландшафт лугов, на которых паслась корова. порода папы_быка — порода папы коровы. Жирность,% — содержание жиров в молоке (в процентах). Белок,% — содержание белков в молоке (в процентах). Вкус молока — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно). Возраст — возраст коровы, бинарный признак (менее2лет, более2лет). Файл ferma_dad.csv хранит имя папы каждой коровы в стаде фермера:

id — уникальный идентификатор коровы. Имя Папы — имя папы коровы. Файл cow_buy.csv содержит данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой:

Порода — порода коровы. Тип пастбища — ландшафт лугов, на которых паслась корова. порода папы_быка — порода папы коровы. Имя_папы — имя папы коровы. Текущая_жирность,% — содержание жиров в молоке (в процентах). Текущий_уровень_белок,% — содержание белков в молоке (в процентах). Возраст — возраст коровы, бинарный признак (менее2лет, более2лет).

План действий:

Загрузка и изучение данных
Предобработка данных
Исследовательский анализ данных
Проведите корреляционный анализ признаков в датасете ferma_main.csv
Задача регрессии
Задача классификации
Общий вывод

Целевым признаком для модели логистической регресии будет категориальный признак 'Вкус молока', а входными признаками будут признаки, которые мы использовали для третьей модели линейной регресии плюс белок ( так как имеет слабый уровень корреляции)

Мы установили, что оптимальным вариантом порога классификации будет являться порог равный 0.73 , который позволит свести риски покупки коровы с невскусным молоком к нулю

Итоговые выводы
Мы получили данные о коровах фермера, имена их отцов и коров на ферме

Мы провели предобработку данных и сделали следующие поправки в данных:

Првиели имена столбцов к нижнему регистру, а так же заменили пробелы и запятые в названиях на '_'
Изменили типы данных для количественных признаков с object на float
Нашли неявные дубликаты в признаках и заменили их
Нашли явыне дубликаты в таблице df_ferma_main и удалили их
Все категориальные данные привели к нижнему регистру
Так же мы провели исслеовательский анализ данных и выявили следующее: для данных в датафрейме df_ferma_main:

В признаке Удой, кг был обнаружен один аномальный объект, было решено его удалить из данных В некоторых признаках было выявлено небольшое количествно аномалий, которые было решено оставить и не удалять: жирность%, белок%

Можно сотсавить портрет типичного объекта в стаде фермера на текущий момент. Это объект с:

Показателем массы молока, которую корова даёт в год (в килограммах) в промежутке от 5749 до 6501.
Показателем питательности корма коровы в промежутке от 13.5 до 16.8
Показателем содержания сырого протеина в корме (в граммах) от 1771 до 2062
Показателем отношение сахара к протеину в корме коровы 0.89 до 0.94
Показателем содержание жиров в молоке (в процентах) от 3.69 до 3.72
Показателем содержание белков в молоке (в процентах) от 3.074 до 3.077
Показателем породы равным вис бик айдиал или рефлешнсоверинг
Показателем тип пастбища равным холмистое или равнинное
Показателем попрода папы равным айдиал или соверин
Показателем вкус молока в большинстве случаев - вкусно
Показатель возраст в большенстве случаев равным - более 2 лет
Показатель имя_папы в большенстве случаев равным - барин или буйный
для данных в датафрейме df_cow_buy:

Аномалий не обнаружено. Объекты в категориальные призаках совпадают с объектами из категориальных признаков основной таблици, количественные признаки находятся в диапазонах подобных диапазноам основной таблици

Мы провели корреляционный анализ и установили следующее:

существует следующие виды связи для признака удой:

очень сильная корреляция удоя от возраста объекта (чем старше объект, тем больше удоя)
сильная положительная связь между удоем и такими количественными признаками, как показатель питательности корма коровы, отношение сахара к протеину в корме коровы, содержание жиров в молоке (в процентах);
средня связь между удоем и таким количественным признаком как содержание сырого протеина в корме, и такими категориальными признаками как порода папы быка ( для породы папы_быка айдиал характерная больший удой, чем для породы папы соверин) , имя папы быка (таким отцов как буйный, геркулес характерны коровы с большим удоем, чем для пап соловчик и барин)
слабая связь существует между удоем и такими категориальными признаками как тип пастбища (Холмистому типу пастбища харкетрен больший удой молока) и вкус молока (вкусному молоку характерен больший удой)
Не обнаружено связи между удоем и такими признаками как порода коровы и содержание белков в молоке
существует следующие виды связи для признака вкус молока:

сильная корреляция вкуса молока от показателем спо (чем выще показатель отношения сахара к протеину в корме коровы, тем вкуснее молко)
слабую связь между вкусом молока и такими признаками как: эке (чем выше показатель питательности корма коровы, тем вкуснее молоко), тип пастбища (типу пастбища холмистое характерно вкусное молоко, чем равнистое), жирность (чем выше показатель содержание жиров в молоке , тем вкуснее молоко), сырой протеин (чем выше показатель содержание сырого протеина в корме , тем вкуснее молоко), возраст (чем старше корова, тем вкуснее молоко), удой (вкусному молоку характерен больший удой)
Не обнаружено или крайне слабая связи между вкусом молока и такими признаками как имя папы, белок, порода папы, порода коровы,
Таким образом сделаем вывод, что между целевыми признаками и входными существует положительная связь, а так же существует мультиклассовая связь для категориальных данных для ряда признаков, хотя и есть признаки, которые никак не связаны с целевыми , такие как содержание белка и порода коровы. Так же можно заметить, что существуют такие сильные связи между входными признаками как:

эке и возраст ( коофициент корреляции 0.77)
эке и жирность ( 0.72)
спо и возраст ( 0.74)
порода папы быка и имя папы ( 0.98)
Данные связи не указвыают на мультикалениарность кроме последнего ( порода папы быка и имя папы ( 0.98)) - данный фактор как имя папы быка не следует использовать для обучения модели МО.

Мы провели обучении момдели линейной регресии и установлили, что третья модель является наиболле оптимальной для решения задачи фермера. Мы спрогнозировали удой у коров и выяснили, что все коровы к расмотрению на покупку имеет удой выше 6000 литров

Так же мы провели обучение модели логистической регресии и установлили, что только одна корова будет иметь вкусное молоко .
